(this["webpackJsonpreact-tetris"]=this["webpackJsonpreact-tetris"]||[]).push([[0],{14:function(n,t,e){},24:function(n,t,e){"use strict";e.r(t);e(14);var r,o,c,i,a,u,s=e(2),l=e(3),d=e(4),f=d.a.div(r||(r=Object(l.a)(["\n  width: 100vw;\n  height: 100vh;\n  background: url(/assets/space.jpg) #000;\n  background-size: cover;\n  overflow: hidden;\n"]))),b=d.a.div(o||(o=Object(l.a)(["\n  display: flex;\n  align-items: flex-start;\n  padding: 40px;\n  margin: 0 auto;\n  max-width: 900px;\n\n  aside {\n    width: 100%;\n    max-width: 200px;\n    display: block;\n    padding: 0 20px;\n  }\n"]))),p=function(){return Array.from(Array(20),(function(){return new Array(12).fill([0,"clear"])}))},j=function(n,t,e){for(var r=e.x,o=e.y,c=0;c<n.tetromino.length;c++)for(var i=0;i<n.tetromino[c].length;i++)if(0!==n.tetromino[c][i]&&(!t[c+n.position.y+o]||!t[c+n.position.y+o][i+n.position.x+r]||"clear"!==t[c+n.position.y+o][i+n.position.x+r][1]))return!0},x=d.a.div(c||(c=Object(l.a)(["\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  margin: 0 0 20px 0;\n  padding: 20px;\n  border: 4px solid #333;\n  min-height: 30px;\n  width: 100%;\n  border-radius: 20px;\n  color: ",";\n  background: #000;\n  font-size: 0.8rem;\n"])),(function(n){return n.gameOver?"red":"#999"})),O=e(1),h=function(n){var t=n.gameOver,e=n.text;return Object(O.jsx)(x,{gameOver:t,children:e})},g=d.a.div(i||(i=Object(l.a)(["\n  width: auto;\n  background: rgba(",", 0.8);\n  border: ",";\n  border-bottom-color: rgba(",", 0.1);\n  border-right-color: rgba(",", 1);\n  border-top-color: rgba(",", 1);\n  border-left-color: rgba(",", 0.1);\n"])),(function(n){return n.color}),(function(n){return 0===n.type?"0px solid":"4px solid"}),(function(n){return n.color}),(function(n){return n.color}),(function(n){return n.color}),(function(n){return n.color})),v={0:{shape:[[0]],color:"0, 0, 0"},I:{shape:[[0,"I",0,0],[0,"I",0,0],[0,"I",0,0],[0,"I",0,0]],color:"80, 227, 230"},J:{shape:[[0,"J",0],[0,"J",0],["J","J",0]],color:"36, 95, 223"},L:{shape:[[0,"L",0],[0,"L",0],[0,"L","L"]],color:"223, 173, 36"},O:{shape:[["0","0"],["0","0"]],color:"223, 217, 36"},S:{shape:[[0,"S","S"],["S","S",0],[0,0,0]],color:"48, 211, 56"},T:{shape:[[0,0,0],["T","T","T"],[0,"T",0]],color:"132, 61, 198"},Z:{shape:[["Z","Z",0],[0,"Z","Z"],[0,0,0]],color:"227, 78, 78"}},m=function(){var n="IJLOSTZ",t=n[Math.floor(Math.random()*n.length)];return v[t]},y=e(0),w=function(n){var t=n.type;return Object(O.jsx)(g,{type:t,color:v[t].color})},k=Object(y.memo)(w),S=d.a.div(a||(a=Object(l.a)(["\n  display: grid;\n  grid-template-rows: repeat(\n    ",",\n    calc(25vw / ",")\n  );\n  grid-template-columns: repeat(",", 1fr);\n  gap: 1px;\n  border: 2px solid #333;\n  width: 100%;\n  max-width: 25vw;\n  background: #111;\n"])),(function(n){return n.height}),(function(n){return n.width}),(function(n){return n.width})),I=function(n){var t=n.stage;return Object(O.jsx)(S,{width:t[0].length,height:t.length,children:t.map((function(n){return n.map((function(n,t){return Object(O.jsx)(k,{type:n[0]},t)}))}))})},J=d.a.button(u||(u=Object(l.a)(["\n  box-sizing: border-box;\n  margin: 0 0 20px 0;\n  padding: 20px;\n  min-height: 30px;\n  width: 100%;\n  border-radius: 20px;\n  border: none;\n  color: white;\n  background: #333;\n  font-size: 1rem;\n"]))),E=function(n){var t=n.callback;return Object(O.jsx)(J,{onClick:t,children:"Start Game"})},L=function(n,t){var e=Object(y.useRef)();Object(y.useEffect)((function(){e.current=n}),[n]),Object(y.useEffect)((function(){if(null!==t){var n=setInterval((function(){e.current()}),t);return function(){clearInterval(n)}}}),[t])},T=e(5),Z=function(n,t){var e=Object(y.useState)(p()),r=Object(s.a)(e,2),o=r[0],c=r[1],i=Object(y.useState)(0),a=Object(s.a)(i,2),u=a[0],l=a[1];return Object(y.useEffect)((function(){l(0);var e=function(e){var r=e.map((function(n){return n.map((function(n){return"clear"===n[1]?[0,"clear"]:n}))}));return n.tetromino.forEach((function(t,e){t.forEach((function(t,o){0!==t&&(r[e+n.position.y][o+n.position.x]=[t,"".concat(n.collided?"merged":"clear")])}))})),n.collided?(t(),function(n){return n.reduce((function(t,e){return-1===e.findIndex((function(n){return 0===n[0]}))?(l((function(n){return n+1})),t.unshift(new Array(n[0].length).fill([0,"clear"])),t):(t.push(e),t)}),[])}(r)):r};c((function(n){return e(n)}))}),[n,t]),[o,c,u]},z=function(){var n=Object(y.useState)(null),t=Object(s.a)(n,2),e=t[0],r=t[1],o=Object(y.useState)(!1),c=Object(s.a)(o,2),i=c[0],a=c[1],u=function(){var n=Object(y.useState)({position:{x:0,y:0},tetromino:v[0].shape,collided:!1}),t=Object(s.a)(n,2),e=t[0],r=t[1],o=function(n,t){var e=n.map((function(t,e){return n.map((function(n){return n[e]}))}));return t>0?e.map((function(n){return n.reverse()})):e.reverse()},c=Object(y.useCallback)((function(){r({position:{x:4,y:0},tetromino:m().shape,collided:!1})}),[]);return[e,function(n){var t=n.x,e=n.y,o=n.collided;r((function(n){return Object(T.a)(Object(T.a)({},n),{},{position:{x:n.position.x+=t,y:n.position.y+=e},collided:o})}))},c,function(n,t){var c=Object(T.a)({},e);c.tetromino=o(c.tetromino,t);for(var i=c.position.x,a=1;j(c,n,{x:0,y:0});)if(c.position.x+=a,(a=-(a+(a>0?1:-1)))>c.tetromino[0].length)return o(c.tetromino,-t),void(c.position.x=i);r(c)}]}(),l=Object(s.a)(u,4),d=l[0],x=l[1],g=l[2],w=l[3],k=Z(d,g),S=Object(s.a)(k,3),J=S[0],z=S[1],C=function(n){var t=Object(y.useState)(0),e=Object(s.a)(t,2),r=e[0],o=e[1],c=Object(y.useState)(0),i=Object(s.a)(c,2),a=i[0],u=i[1],l=Object(y.useState)(0),d=Object(s.a)(l,2),f=d[0],b=d[1],p=Object(y.useMemo)((function(){}),[]);p=[40,100,300,1200];var j=Object(y.useCallback)((function(){n>0&&(o((function(t){return t+p[n-1]*(f+1)})),u((function(t){return t+n})))}),[f,p,n]);return Object(y.useEffect)((function(){j()}),[j,n,r]),[r,o,a,u,f,b]}(S[2]),A=Object(s.a)(C,6),M=A[0],G=A[1],K=A[2],R=A[3],B=A[4],D=A[5];console.log("re-render");var U=function(n){j(d,J,{x:n,y:0})||x({x:n,y:0})},q=function(){K>10*(B+1)&&(D((function(n){return n+1})),r(1e3/(B+1)+200)),j(d,J,{x:0,y:1})?(d.position.y<1&&(a(!0),r(null)),x({x:0,y:0,collided:!0})):x({x:0,y:1,collided:!1})},F=function(n){var t=n.keyCode;if(!i)switch(t){case 32:!function(){for(var n=0;!j(d,J,{x:0,y:n});)n+=1;x({x:0,y:n-1,collided:!0})}();break;case 37:U(-1);break;case 38:w(J,1);break;case 39:U(1);break;case 40:r(null),q()}};return L((function(){q()}),e),Object(O.jsx)(f,{role:"button",tabIndex:"0",onKeyDown:function(n){return F(n)},onKeyUp:function(n){var t=n.keyCode;i||40===t&&r(1e3/(B+1)+200)},children:Object(O.jsxs)(b,{children:[Object(O.jsx)(I,{stage:J}),Object(O.jsxs)("aside",{children:[i&&Object(O.jsx)(h,{gameOver:i,text:"Game Over"}),!i&&Object(O.jsxs)("div",{children:[Object(O.jsx)(h,{text:"Score: ".concat(M)}),Object(O.jsx)(h,{text:"Rows: ".concat(K)}),Object(O.jsx)(h,{text:"Level: ".concat(B)})]}),Object(O.jsx)(E,{callback:function(){z(p()),r(1e3),g(),a(!1),G(0),R(0),D(0)}})]})]})})},C=function(){return Object(O.jsx)(z,{})},A=e(13);e.n(A).a.render(Object(O.jsx)(C,{}),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.14820051.chunk.js.map